import{d as U,i as N,u as V,r as R,k as F,a1 as G,c as p,e as c,w as d,f as r,a as S,g as m,h as y,q,F as M,D as j,p as x,x as l}from"./index-BGwiQ_ZP.js";import{a as z}from"./sysTenant-CUNJZJDU.js";import{c as A}from"./sysOrg-CYUW6V7f.js";import{C as H}from"./index-O9UFCIBE.js";import{S as J,a as Q}from"./index-CKmLu0Sy.js";import{b as W}from"./index-BwLVAfvf.js";import{_ as X}from"./index-BUzwvh4O.js";import{_ as Y,a as Z}from"./index-4yq-Tlp0.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DkgGzfF8.js";import"./_getTag-BRywsnft.js";import"./KeyCode-CYuXKwrG.js";import"./index-BjablQaC.js";import"./devWarning-MTSIIkhh.js";import"./index-DzzgRnZQ.js";import"./zoom-CXqzwkKe.js";import"./vnode-BaoCyZaz.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-D2RrGThV.js";import"./slide-NWV3xR2G.js";import"./index-Dn-jGRft.js";import"./Dropdown-C4JaQ-9X.js";import"./useState-DblkWJ1i.js";import"./hasIn-B69yjgv2.js";import"./isMobile-BbN7I0i_.js";import"./useMergedState-DA2nm7bB.js";import"./omit-HeMvMqzr.js";import"./isPlainObject-DJIrIqvg.js";import"./index-CGXbiuUf.js";import"./index-CalSw2eR.js";import"./css-DXc8wDa4.js";import"./compact-item-CDNQQAbH.js";import"./pickAttrs-DQvtcfDv.js";import"./createRef-CUnV3TOs.js";import"./move-wLULaQ1Q.js";import"./List-163jSJPW.js";import"./useMemo-BMsKZuSN.js";import"./index-_DVN_kvK.js";import"./index-BRrv4Ip6.js";import"./eagerComputed-DIhAf9GU.js";import"./debounce-BUZtn0sP.js";import"./Col-DruUELZH.js";import"./responsiveObserve-ChmocN4c.js";import"./styleChecker-DfAMPleG.js";const ee={class:"org-tree-container h-full"},te={class:"p-2.5"},oe={key:0},ae={style:{color:"#f50"}},ne={key:1},se=U({__name:"orgTree",props:{tenantId:{},checkable:{type:Boolean,default:!1}},emits:["node-click"],setup(v,{expose:T,emit:C}){const f=v,I=C,w=N(),k=V(),g=[],e=R({formState:{filterText:"",tenantId:f.tenantId},tenantList:[],orgData:[],loading:!1,expandedKeys:[],autoExpandParent:!1,checkedKeys:[],selectedKeys:[]}),h=t=>{for(let o=0;o<t.length;o++){const n=t[o];n.id,g.push({...n}),n.children&&h(n.children)}},u=(t,o)=>{let n;for(let i=0;i<o.length;i++){const s=o[i];s.children&&(s.children.some(_=>_.id===t)?n=s.id:u(t,s.children)&&(n=u(t,s.children)))}return n},K=async()=>{e.loading=!0;const t=await A(0,void 0,void 0,void 0,e.formState.tenantId);e.orgData=t.data.result,h(e.orgData),e.loading=!1},b=t=>{e.expandedKeys=t,e.autoExpandParent=!1};F(async()=>{if(k.state.userInfos.accountType===999){const t=await z();e.tenantList=t.data.result}K()}),G(()=>e.formState.filterText,t=>{const o=g.map(n=>n.name.indexOf(t)>-1?u(n.id,e.orgData):null).filter((n,i,s)=>n&&s.indexOf(n)===i);e.expandedKeys=o,e.autoExpandParent=!0});const D=t=>{I("node-click",t)},L=t=>{console.log(t)};return T({setCheckedKeys:t=>{e.checkedKeys=t,e.selectedKeys=t,e.expandedKeys=t,e.autoExpandParent=!0},getCheckedKeys:()=>e.checkedKeys}),(t,o)=>{const n=Q,i=J,s=Z,_=W,E=Y,O=X,B=H;return r(),p("div",ee,[c(B,{class:"h-full"},{default:d(()=>[S("header",te,[c(E,{gutter:[0,16]},{default:d(()=>[f.tenantId?y("",!0):(r(),m(s,{key:0,span:24},{default:d(()=>[q(k).state.userInfos.accountType==999?(r(),m(i,{key:0,value:e.formState.tenantId,"onUpdate:value":o[0]||(o[0]=a=>e.formState.tenantId=a),placeholder:"请选择租户",class:"w-full",onChange:K,allowClear:""},{default:d(()=>[(r(!0),p(M,null,j(e.tenantList,a=>(r(),m(n,{key:a.value,value:a.value},{default:d(()=>[x(l(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])):y("",!0)]),_:1})),c(s,{span:24},{default:d(()=>[c(_,{value:e.formState.filterText,"onUpdate:value":o[1]||(o[1]=a=>e.formState.filterText=a),placeholder:"机构名称",allowClear:""},null,8,["value"])]),_:1})]),_:1})]),e.loading?y("",!0):(r(),m(O,{key:0,ref_key:"treeRef",ref:w,"expanded-keys":e.expandedKeys,"onUpdate:expandedKeys":o[2]||(o[2]=a=>e.expandedKeys=a),"checked-keys":e.checkedKeys,"onUpdate:checkedKeys":o[3]||(o[3]=a=>e.checkedKeys=a),"selected-keys":e.selectedKeys,"onUpdate:selectedKeys":o[4]||(o[4]=a=>e.selectedKeys=a),"auto-expand-parent":e.autoExpandParent,"tree-data":e.orgData,fieldNames:{key:"id"},checkable:f.checkable,onExpand:b,onSelect:o[5]||(o[5]=(a,P)=>D(P.node.dataRef)),onCheck:L},{title:d(({name:a})=>[a.indexOf(e.formState.filterText)>-1?(r(),p("span",oe,[x(l(a.substring(0,a.indexOf(e.formState.filterText)))+" ",1),S("span",ae,l(e.formState.filterText),1),x(" "+l(a.substring(a.indexOf(e.formState.filterText)+e.formState.filterText.length)),1)])):(r(),p("span",ne,l(a),1))]),_:1},8,["expanded-keys","checked-keys","selected-keys","auto-expand-parent","tree-data","checkable"]))]),_:1})])}}}),Ze=$(se,[["__scopeId","data-v-c715e9cf"]]);export{Ze as default};
