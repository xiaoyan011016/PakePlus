import{f as E,g as Q,h as V}from"./sysRole-B9nNQdEO.js";import{d as A,i as x,u as H,r as j,o as G,c as p,e as s,w as l,f as i,g as y,h as m,q as f,F as c,D as C,p as d,x as _,E as S,cM as J,cs as K,ct as W,I as F,C as X}from"./index-BGwiQ_ZP.js";import{a as Y}from"./sysTenant-CUNJZJDU.js";import"./orgTree-BVmU2Phx.js";import{C as Z}from"./index-Dmp49pi4.js";import{C as tt}from"./index-DXr50enF.js";import{_ as et}from"./edit-record-history-b6VxML3W.js";import{_ as at}from"./dataScopeModal.vue_vue_type_script_setup_true_lang-BZjRvtN0.js";import{u as ot}from"./useGetDictList-Ce8qcgxG.js";import nt from"./editRole-DTtaytbz.js";import{C as rt}from"./index-O9UFCIBE.js";import{S as st,a as it}from"./index-CKmLu0Sy.js";import{I as lt}from"./index-BwLVAfvf.js";import{T as pt}from"./index-BZPc_wGj.js";import{B as mt}from"./index-_DVN_kvK.js";import{_ as dt}from"./index-C3-0t2lO.js";import{_ as ut}from"./index-Z14lAvnM.js";import{_ as ct}from"./index-Dc3BwS3p.js";import{_ as _t}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sysOrg-CYUW6V7f.js";import"./index-BUzwvh4O.js";import"./index-BRrv4Ip6.js";import"./omit-HeMvMqzr.js";import"./List-163jSJPW.js";import"./index-Dn-jGRft.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./createRef-CUnV3TOs.js";import"./_getTag-BRywsnft.js";import"./zoom-CXqzwkKe.js";import"./devWarning-MTSIIkhh.js";import"./pickAttrs-DQvtcfDv.js";import"./eagerComputed-DIhAf9GU.js";import"./collapseMotion-D2RrGThV.js";import"./KeyCode-CYuXKwrG.js";import"./debounce-BUZtn0sP.js";import"./hasIn-B69yjgv2.js";import"./index-DzzgRnZQ.js";import"./vnode-BaoCyZaz.js";import"./index-4yq-Tlp0.js";import"./Col-DruUELZH.js";import"./responsiveObserve-ChmocN4c.js";import"./styleChecker-DfAMPleG.js";import"./index-DkgGzfF8.js";import"./index-BjablQaC.js";import"./slide-NWV3xR2G.js";import"./Dropdown-C4JaQ-9X.js";import"./useState-DblkWJ1i.js";import"./isMobile-BbN7I0i_.js";import"./useMergedState-DA2nm7bB.js";import"./isPlainObject-DJIrIqvg.js";import"./index-CGXbiuUf.js";import"./index-CalSw2eR.js";import"./css-DXc8wDa4.js";import"./compact-item-CDNQQAbH.js";import"./move-wLULaQ1Q.js";import"./useMemo-BMsKZuSN.js";import"./file-B2ejoaTr.js";import"./index-C0T18UR7.js";import"./index-ENtatNUe.js";import"./index-CT-EkvtY.js";import"./Checkbox-BZ1yw4ia.js";import"./index-Bp3RETpT.js";import"./index-CEnhULtM.js";import"./index-Bh7qAkTT.js";import"./useBreakpoint-CpQcD87b.js";import"./index-DQufTizB.js";import"./index-Dpm5AXGB.js";import"./ActionButton-4KVVUbhX.js";import"./lodash-buJ1Dk2D.js";import"./index-CrTOvIq5.js";const ft={class:"sys-role-container flex flex-col"},yt={key:2,style:{cursor:"pointer"}},gt={key:3,class:"w-full"},vt=A({name:"sysRole",__name:"index",setup(ht){const g=x(),k=H(),w=x(),t=j({queryForm:{tenantId:void 0,name:void 0,code:void 0},tableData:[],loading:!1,tenantList:[],tableParams:{page:1,pageSize:50,total:0}}),R=[{title:"序号",align:"center",width:60,customRender:({index:e})=>`${e+1}`,fixed:"left"},{title:"角色名称",dataIndex:"name",key:"name",align:"center",width:150},{title:"角色编码",dataIndex:"code",key:"code",align:"center",width:150},{title:"数据范围",dataIndex:"dataScope",key:"dataScope",align:"center",width:150},{title:"排序",dataIndex:"orderNo",key:"orderNo",align:"center",width:150},{title:"状态",dataIndex:"status",key:"status",align:"center",width:150},{title:"修改记录",dataIndex:"history",key:"history",align:"center",width:150},{title:"操作",align:"center",key:"operation",dataIndex:"operation",width:250,fixed:"right"}],q=()=>{var e;(e=g.value)==null||e.handleOpen({id:void 0,status:1,tenantId:t.queryForm.tenantId,orderNo:100})},P=e=>{var a;(a=g.value)==null||a.handleOpen(e)},O=async()=>{t.queryForm={tenantId:void 0,name:void 0,code:void 0},t.queryForm.tenantId=t.tenantList[0].value,await u()},D=async e=>{await Q({id:e.id}),F("删除成功","success"),await u()},u=async()=>{t.loading=!0;let e=Object.assign(t.queryForm,t.tableParams),a=await E({...e});t.tableData=a.data.result.items??[],t.tableParams.total=a.data.result.total??0,t.loading=!1},L=async e=>{t.tableParams.page=e.current,t.tableParams.pageSize=e.pageSize,await u()},T=e=>{var a;(a=w.value)==null||a.handleOpen(e)},$=async e=>{await V({id:e.id,status:e.status?1:2}),F("操作成功","success"),await u(),X.emit("posOrRoleUpdate")};return G(async()=>{if(k.state.userInfos.accountType===999){const e=await Y();t.tenantList=e.data.result,t.queryForm.tenantId=t.tenantList[0].value}await u()}),(e,a)=>{const z=it,U=st,v=dt,I=lt,b=rt,B=pt,M=ut,h=mt,N=ct;return i(),p("div",ft,[s(b,{class:"mb-2.5"},{default:l(()=>[s(Z,{model:t.queryForm,name:"menu-form",onQuery:u,onAdd:q,onReset:O},{default:l(()=>[f(k).state.userInfos.accountType==999?(i(),y(v,{key:0,label:"租户",name:"tenantId",style:{width:"250px"}},{default:l(()=>[s(U,{value:t.queryForm.tenantId,"onUpdate:value":a[0]||(a[0]=r=>t.queryForm.tenantId=r),placeholder:""},{default:l(()=>[(i(!0),p(c,null,C(t.tenantList,r=>(i(),y(z,{key:r.value,value:r.value},{default:l(()=>[d(_(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):m("",!0),s(v,{label:"角色名称",name:"name",class:"w-1/2.5"},{default:l(()=>[s(I,{value:t.queryForm.name,"onUpdate:value":a[1]||(a[1]=r=>t.queryForm.name=r)},null,8,["value"])]),_:1}),s(v,{label:"角色编码",name:"code",class:"w-1/2.5"},{default:l(()=>[s(I,{value:t.queryForm.code,"onUpdate:value":a[2]||(a[2]=r=>t.queryForm.code=r)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),s(b,{class:"flex-1 card-table"},{default:l(()=>[s(tt,{columns:R,data:t.tableData,pagination:{total:t.tableParams.total,current:t.tableParams.page,pageSize:t.tableParams.pageSize,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["2","5","10","20"],showTotal:r=>`总数: ${r}`},loading:t.loading,onChange:L},{bodyCell:l(({column:r,text:St,record:o})=>[r.dataIndex==="dataScope"?(i(),y(B,{key:0,color:"cyan"},{default:l(()=>[(i(!0),p(c,null,C(f(ot)("DataScopeEnum"),n=>(i(),p(c,{key:n.value},[o.dataScope==1&&o.dataScope==n.value?(i(),p(c,{key:0},[d(_(n.label),1)],64)):m("",!0),o.dataScope==2&&o.dataScope==n.value?(i(),p(c,{key:1},[d(_(n.label),1)],64)):m("",!0),o.dataScope==3&&o.dataScope==n.value?(i(),p(c,{key:2},[d(_(n.label),1)],64)):m("",!0),o.dataScope==4&&o.dataScope==n.value?(i(),p(c,{key:3},[d(_(n.label),1)],64)):m("",!0),o.dataScope==5&&o.dataScope==n.value?(i(),p(c,{key:4},[d(_(n.label),1)],64)):m("",!0)],64))),128))]),_:2},1024)):m("",!0),r.dataIndex==="status"?(i(),y(M,{key:1,checked:o.status,"onUpdate:checked":n=>o.status=n,checkedValue:1,onChange:n=>$(o)},null,8,["checked","onUpdate:checked","onChange"])):m("",!0),r.dataIndex==="history"?(i(),p("div",yt,[s(et,{row:o},null,8,["row"])])):m("",!0),r.dataIndex==="operation"?(i(),p("div",gt,[s(h,{icon:S(f(J)),ghost:"",type:"primary",class:"mr-1",onClick:n=>T(o)},{default:l(()=>a[3]||(a[3]=[d("数据范围")])),_:2},1032,["icon","onClick"]),s(h,{icon:S(f(K)),ghost:"",type:"primary",class:"mr-1",onClick:n=>P(o)},{default:l(()=>a[4]||(a[4]=[d("编辑")])),_:2},1032,["icon","onClick"]),s(N,{title:"确定删除?",onConfirm:n=>D(o)},{default:l(()=>[s(h,{icon:S(f(W)),danger:""},{default:l(()=>a[5]||(a[5]=[d("删除")])),_:1},8,["icon"])]),_:2},1032,["onConfirm"])])):m("",!0)]),_:1},8,["data","pagination","loading"])]),_:1}),s(at,{ref_key:"dataScopeModalRef",ref:w,onHandleQuery:u},null,512),s(nt,{ref_key:"editRoleRef",ref:g,onHandleQuery:u},null,512)])}}}),Ue=_t(vt,[["__scopeId","data-v-cabc793f"]]);export{Ue as default};
