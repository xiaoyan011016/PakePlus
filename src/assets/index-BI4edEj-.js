import{C as O}from"./index-Dmp49pi4.js";import{C as R}from"./index-DXr50enF.js";import{d as B,u as U,i as A,r as E,o as $,c as d,e as n,w as r,f as s,g as p,h as l,q as f,F as v,D as z,p as u,x as k,E as h,cs as Q,ct as V,I as G,C as M}from"./index-BGwiQ_ZP.js";import{a as H}from"./sysTenant-CUNJZJDU.js";import{c as j,d as J}from"./sysPos-BbYKGNVi.js";import{_ as K}from"./edit-record-history-b6VxML3W.js";import W from"./dataDetail-DAkEfDjG.js";import{_ as X}from"./editPos.vue_vue_type_script_setup_true_lang-BNuvLBP6.js";import{C as Y}from"./index-O9UFCIBE.js";import{S as Z,a as tt}from"./index-CKmLu0Sy.js";import{I as et}from"./index-BwLVAfvf.js";import{T as at}from"./index-BZPc_wGj.js";import{B as ot}from"./index-_DVN_kvK.js";import{_ as nt}from"./index-C3-0t2lO.js";import{_ as rt}from"./index-Dc3BwS3p.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./file-B2ejoaTr.js";import"./index-C0T18UR7.js";import"./Dropdown-C4JaQ-9X.js";import"./index-DzzgRnZQ.js";import"./_getTag-BRywsnft.js";import"./zoom-CXqzwkKe.js";import"./vnode-BaoCyZaz.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./move-wLULaQ1Q.js";import"./slide-NWV3xR2G.js";import"./index-Dn-jGRft.js";import"./devWarning-MTSIIkhh.js";import"./omit-HeMvMqzr.js";import"./index-BjablQaC.js";import"./collapseMotion-D2RrGThV.js";import"./KeyCode-CYuXKwrG.js";import"./index-ENtatNUe.js";import"./index-CT-EkvtY.js";import"./Checkbox-BZ1yw4ia.js";import"./index-CalSw2eR.js";import"./css-DXc8wDa4.js";import"./compact-item-CDNQQAbH.js";import"./index-BRrv4Ip6.js";import"./index-Bp3RETpT.js";import"./styleChecker-DfAMPleG.js";import"./eagerComputed-DIhAf9GU.js";import"./useState-DblkWJ1i.js";import"./pickAttrs-DQvtcfDv.js";import"./index-CEnhULtM.js";import"./index-Bh7qAkTT.js";import"./useBreakpoint-CpQcD87b.js";import"./responsiveObserve-ChmocN4c.js";import"./useMergedState-DA2nm7bB.js";import"./index-DQufTizB.js";import"./index-BUzwvh4O.js";import"./List-163jSJPW.js";import"./createRef-CUnV3TOs.js";import"./debounce-BUZtn0sP.js";import"./hasIn-B69yjgv2.js";import"./index-4yq-Tlp0.js";import"./Col-DruUELZH.js";import"./index-Dpm5AXGB.js";import"./ActionButton-4KVVUbhX.js";import"./index-CrTOvIq5.js";import"./isMobile-BbN7I0i_.js";import"./index-DkgGzfF8.js";import"./isPlainObject-DJIrIqvg.js";import"./index-CGXbiuUf.js";import"./useMemo-BMsKZuSN.js";const it={class:"sys-pos-container flex flex-col"},lt={key:0},mt={key:3,style:{cursor:"pointer"}},dt={key:4,class:"w-full"},pt=B({name:"sysPos",__name:"index",setup(ut){const y=U(),c=A(),t=E({queryForm:{},tableParams:{page:1,pageSize:10,total:0},tableData:[],loading:!1,tenantList:[]}),F=[{title:"序号",align:"center",width:60,customRender:({index:a})=>`${a+1}`,fixed:"left"},{title:"职位名称",dataIndex:"name",key:"name",align:"center",width:100},{title:"职位编码",dataIndex:"code",key:"code",align:"center",width:80},{title:"在职人数",dataIndex:"userList",key:"userList",align:"center",width:80},{title:"人员明细",dataIndex:"userListDetail",key:"userListDetail",align:"center",width:80},{title:"排序",dataIndex:"orderNo",key:"orderNo",align:"center",width:50},{title:"状态",dataIndex:"status",key:"status",align:"center",width:80},{title:"修改记录",dataIndex:"history",key:"history",align:"center",width:80},{title:"操作",align:"center",key:"operation",dataIndex:"operation",width:150,fixed:"right"}],m=async()=>{t.loading=!0;const a=await j(t.queryForm.name,t.queryForm.code,t.queryForm.tenantId);t.tableData=a.data.result,t.loading=!1},L=async()=>{var a;(a=c.value)==null||a.handleOpen({status:1,tenantId:t.queryForm.tenantId,orderNo:100})},q=async()=>{t.queryForm={},t.queryForm.tenantId=t.tenantList[0].value,await m()},C=async a=>{t.tableParams.page=a.current,t.tableParams.pageSize=a.pageSize,await m()},b=async a=>{var e;(e=c.value)==null||e.handleOpen(a)},D=async a=>{await J({id:a.id}),G("删除成功","success"),await m(),M.emit("posOrRoleUpdate")};return $(async()=>{if(y.state.userInfos.accountType===999){const a=await H();t.tenantList=a.data.result,t.queryForm.tenantId=t.tenantList[0].value}await m()}),(a,e)=>{const S=tt,P=Z,_=nt,g=et,I=Y,x=at,w=ot,T=rt;return s(),d("div",it,[n(I,{class:"mb-2.5"},{default:r(()=>[n(O,{model:t.queryForm,name:"menu-form",onQuery:m,onAdd:L,onReset:q},{default:r(()=>[f(y).state.userInfos.accountType==999?(s(),p(_,{key:0,label:"租户",name:"tenantId",style:{width:"250px"}},{default:r(()=>[n(P,{value:t.queryForm.tenantId,"onUpdate:value":e[0]||(e[0]=o=>t.queryForm.tenantId=o),placeholder:""},{default:r(()=>[(s(!0),d(v,null,z(t.tenantList,o=>(s(),p(S,{key:o.value,value:o.value},{default:r(()=>[u(k(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):l("",!0),n(_,{label:"职位名称",name:"name",class:"w-1/2.5"},{default:r(()=>[n(g,{value:t.queryForm.name,"onUpdate:value":e[1]||(e[1]=o=>t.queryForm.name=o)},null,8,["value"])]),_:1}),n(_,{label:"职位编码",name:"code",class:"w-1/2.5"},{default:r(()=>[n(g,{value:t.queryForm.code,"onUpdate:value":e[2]||(e[2]=o=>t.queryForm.code=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),n(I,{class:"flex-1 card-table"},{default:r(()=>[n(R,{columns:F,data:t.tableData,pagination:!1,loading:t.loading,onChange:C},{bodyCell:r(({column:o,text:ct,record:i})=>[o.dataIndex=="userList"?(s(),d("span",lt,k(Array.isArray(i.userList)?i.userList.length:0),1)):l("",!0),o.dataIndex=="userListDetail"?(s(),p(W,{key:1,data:i.userList},null,8,["data"])):l("",!0),o.dataIndex==="status"?(s(),d(v,{key:2},[i.status==1?(s(),p(x,{key:0,color:"green"},{default:r(()=>e[3]||(e[3]=[u("启用")])),_:1})):l("",!0),i.status==2?(s(),p(x,{key:1,color:"red"},{default:r(()=>e[4]||(e[4]=[u("禁用")])),_:1})):l("",!0)],64)):l("",!0),o.dataIndex==="history"?(s(),d("div",mt,[n(K,{row:i},null,8,["row"])])):l("",!0),o.dataIndex==="operation"?(s(),d("div",dt,[n(w,{icon:h(f(Q)),ghost:"",type:"primary",class:"mr-1",onClick:N=>b(i)},{default:r(()=>e[5]||(e[5]=[u("编辑")])),_:2},1032,["icon","onClick"]),n(T,{title:"确定删除?",onConfirm:N=>D(i)},{default:r(()=>[n(w,{icon:h(f(V)),danger:""},{default:r(()=>e[6]||(e[6]=[u("删除")])),_:1},8,["icon"])]),_:2},1032,["onConfirm"])])):l("",!0)]),_:1},8,["data","loading"])]),_:1}),n(X,{ref_key:"editPosRef",ref:c,onHandleQuery:m},null,512)])}}}),Le=st(pt,[["__scopeId","data-v-68d00a9a"]]);export{Le as default};
