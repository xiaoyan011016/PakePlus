import{d as h,i as d,r as C,c as f,h as w,e as n,w as s,f as c,aB as O,F as x,D as M,q as R,g as T,p as D,x as N,aC as b,I as F}from"./index-BGwiQ_ZP.js";import{u as B}from"./useGetDictList-Ce8qcgxG.js";import L from"./orgTree-BVmU2Phx.js";import{a as I,b as V}from"./sysRole-B9nNQdEO.js";import{M as E}from"./index-Dpm5AXGB.js";import{F as G,_ as J}from"./index-C3-0t2lO.js";import{S as K,a as Q}from"./index-CKmLu0Sy.js";const X=h({__name:"dataScopeModal",emits:["handleQuery"],setup(U,{expose:i,emit:u}){const _=u,S=d(),l=d(),e=C({open:!1,formState:{}}),y=async()=>{var a;e.formState.dataScope==5&&(e.formState.orgIdList=(a=l.value)==null?void 0:a.getCheckedKeys()),await V(e.formState),F("操作成功","success"),p(),_("handleQuery")},p=()=>{e.open=!1};return i({handleOpen:async a=>{if(e.open=!0,e.formState=JSON.parse(JSON.stringify(a)),e.formState.dataScope==5){if(!a.id)return;const o=await I(a.id);setTimeout(()=>{var r;(r=l.value)==null||r.setCheckedKeys(o.data.result)},100)}}}),(a,o)=>{const r=Q,g=K,m=J,v=G,k=E;return e.open?(c(),f("div",{key:0,class:"data-scope-modal",ref_key:"dataScopeModalRef",ref:S},[n(k,{width:"500px",wrapClassName:"custom-modal",open:e.open,"onUpdate:open":o[1]||(o[1]=t=>e.open=t),title:"数据范围",cancelText:"取消",okText:"确定",onOk:y,onCancel:p,getContainer:()=>a.$refs.dataScopeModalRef},{default:s(()=>[n(v,{model:e.formState,name:"dataScopeForm",autocomplete:"off",class:"w-full",layout:"vertical"},{default:s(()=>[n(m,{label:"数据范围"},{default:s(()=>[n(g,{class:"w-full",value:e.formState.dataScope,"onUpdate:value":o[0]||(o[0]=t=>e.formState.dataScope=t)},{default:s(()=>[(c(!0),f(x,null,M(R(B)("DataScopeEnum"),t=>(c(),T(r,{key:t.value,value:+t.value},{default:s(()=>[D(N(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),O(n(m,{label:"机构列表"},{default:s(()=>[n(L,{ref_key:"orgTreeRef",ref:l,"tenant-id":e.formState.tenantId,checkable:!0},null,8,["tenant-id"])]),_:1},512),[[b,e.formState.dataScope==5]])]),_:1},8,["model"])]),_:1},8,["open","getContainer"])],512)):w("",!0)}}});export{X as _};
