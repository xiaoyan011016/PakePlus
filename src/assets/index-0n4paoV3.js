var lt={exports:{}},ai=lt.exports,Pt;function at(){return Pt||(Pt=1,function(v,k){(function(){var D,b=0xdeadbeefcafe,M=(b&16777215)==15715070;function r(t,e,i){t!=null&&(typeof t=="number"?this.fromNumber(t,e,i):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}function m(){return new r(null)}function c(t,e,i,n,u,l){for(;--l>=0;){var y=e*this[t++]+i[n]+u;u=Math.floor(y/67108864),i[n++]=y&67108863}return u}function w(t,e,i,n,u,l){for(var y=e&32767,T=e>>15;--l>=0;){var N=this[t]&32767,j=this[t++]>>15,Y=T*N+j*y;N=y*N+((Y&32767)<<15)+i[n]+(u&1073741823),u=(N>>>30)+(Y>>>15)+T*j+(u>>>30),i[n++]=N&1073741823}return u}function p(t,e,i,n,u,l){for(var y=e&16383,T=e>>14;--l>=0;){var N=this[t]&16383,j=this[t++]>>14,Y=T*N+j*y;N=y*N+((Y&16383)<<14)+i[n]+u,u=(N>>28)+(Y>>14)+T*j,i[n++]=N&268435455}return u}var d=typeof navigator<"u";d&&M&&navigator.appName=="Microsoft Internet Explorer"?(r.prototype.am=w,D=30):d&&M&&navigator.appName!="Netscape"?(r.prototype.am=c,D=26):(r.prototype.am=p,D=28),r.prototype.DB=D,r.prototype.DM=(1<<D)-1,r.prototype.DV=1<<D;var F=52;r.prototype.FV=Math.pow(2,F),r.prototype.F1=F-D,r.prototype.F2=2*D-F;var B="0123456789abcdefghijklmnopqrstuvwxyz",E=new Array,S,P;for(S=48,P=0;P<=9;++P)E[S++]=P;for(S=97,P=10;P<36;++P)E[S++]=P;for(S=65,P=10;P<36;++P)E[S++]=P;function f(t){return B.charAt(t)}function a(t,e){var i=E[t.charCodeAt(e)];return i??-1}function h(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function o(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function x(t){var e=m();return e.fromInt(t),e}function s(t,e){var i;if(e==16)i=4;else if(e==8)i=3;else if(e==256)i=8;else if(e==2)i=1;else if(e==32)i=5;else if(e==4)i=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,u=!1,l=0;--n>=0;){var y=i==8?t[n]&255:a(t,n);if(y<0){t.charAt(n)=="-"&&(u=!0);continue}u=!1,l==0?this[this.t++]=y:l+i>this.DB?(this[this.t-1]|=(y&(1<<this.DB-l)-1)<<l,this[this.t++]=y>>this.DB-l):this[this.t-1]|=y<<l,l+=i,l>=this.DB&&(l-=this.DB)}i==8&&(t[0]&128)!=0&&(this.s=-1,l>0&&(this[this.t-1]|=(1<<this.DB-l)-1<<l)),this.clamp(),u&&r.ZERO.subTo(this,this)}function g(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function I(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var i=(1<<e)-1,n,u=!1,l="",y=this.t,T=this.DB-y*this.DB%e;if(y-- >0)for(T<this.DB&&(n=this[y]>>T)>0&&(u=!0,l=f(n));y>=0;)T<e?(n=(this[y]&(1<<T)-1)<<e-T,n|=this[--y]>>(T+=this.DB-e)):(n=this[y]>>(T-=e)&i,T<=0&&(T+=this.DB,--y)),n>0&&(u=!0),u&&(l+=f(n));return u?l:"0"}function A(){var t=m();return r.ZERO.subTo(this,t),t}function C(){return this.s<0?this.negate():this}function V(t){var e=this.s-t.s;if(e!=0)return e;var i=this.t;if(e=i-t.t,e!=0)return this.s<0?-e:e;for(;--i>=0;)if((e=this[i]-t[i])!=0)return e;return 0}function q(t){var e=1,i;return(i=t>>>16)!=0&&(t=i,e+=16),(i=t>>8)!=0&&(t=i,e+=8),(i=t>>4)!=0&&(t=i,e+=4),(i=t>>2)!=0&&(t=i,e+=2),(i=t>>1)!=0&&(t=i,e+=1),e}function O(){return this.t<=0?0:this.DB*(this.t-1)+q(this[this.t-1]^this.s&this.DM)}function H(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function L(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function U(t,e){var i=t%this.DB,n=this.DB-i,u=(1<<n)-1,l=Math.floor(t/this.DB),y=this.s<<i&this.DM,T;for(T=this.t-1;T>=0;--T)e[T+l+1]=this[T]>>n|y,y=(this[T]&u)<<i;for(T=l-1;T>=0;--T)e[T]=0;e[l]=y,e.t=this.t+l+1,e.s=this.s,e.clamp()}function W(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t){e.t=0;return}var n=t%this.DB,u=this.DB-n,l=(1<<n)-1;e[0]=this[i]>>n;for(var y=i+1;y<this.t;++y)e[y-i-1]|=(this[y]&l)<<u,e[y-i]=this[y]>>n;n>0&&(e[this.t-i-1]|=(this.s&l)<<u),e.t=this.t-i,e.clamp()}function K(t,e){for(var i=0,n=0,u=Math.min(t.t,this.t);i<u;)n+=this[i]-t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n-=t[i],e[i++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[i++]=this.DV+n:n>0&&(e[i++]=n),e.t=i,e.clamp()}function nt(t,e){var i=this.abs(),n=t.abs(),u=i.t;for(e.t=u+n.t;--u>=0;)e[u]=0;for(u=0;u<n.t;++u)e[u+i.t]=i.am(0,n[u],e,u,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&r.ZERO.subTo(e,e)}function st(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var n=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,n,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function ot(t,e,i){var n=t.abs();if(!(n.t<=0)){var u=this.abs();if(u.t<n.t){e!=null&&e.fromInt(0),i!=null&&this.copyTo(i);return}i==null&&(i=m());var l=m(),y=this.s,T=t.s,N=this.DB-q(n[n.t-1]);N>0?(n.lShiftTo(N,l),u.lShiftTo(N,i)):(n.copyTo(l),u.copyTo(i));var j=l.t,Y=l[j-1];if(Y!=0){var G=Y*(1<<this.F1)+(j>1?l[j-2]>>this.F2:0),Q=this.FV/G,ut=(1<<this.F1)/G,$=1<<this.F2,J=i.t,ct=J-j,tt=e??m();for(l.dlShiftTo(ct,tt),i.compareTo(tt)>=0&&(i[i.t++]=1,i.subTo(tt,i)),r.ONE.dlShiftTo(j,tt),tt.subTo(l,l);l.t<j;)l[l.t++]=0;for(;--ct>=0;){var gt=i[--J]==Y?this.DM:Math.floor(i[J]*Q+(i[J-1]+$)*ut);if((i[J]+=l.am(0,gt,i,ct,0,j))<gt)for(l.dlShiftTo(ct,tt),i.subTo(tt,i);i[J]<--gt;)i.subTo(tt,i)}e!=null&&(i.drShiftTo(j,e),y!=T&&r.ZERO.subTo(e,e)),i.t=j,i.clamp(),N>0&&i.rShiftTo(N,i),y<0&&r.ZERO.subTo(i,i)}}}function ft(t){var e=m();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(r.ZERO)>0&&t.subTo(e,e),e}function R(t){this.m=t}function kt(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Zt(t){return t}function Ut(t){t.divRemTo(this.m,null,t)}function _t(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function Gt(t,e){t.squareTo(e),this.reduce(e)}R.prototype.convert=kt,R.prototype.revert=Zt,R.prototype.reduce=Ut,R.prototype.mulTo=_t,R.prototype.sqrTo=Gt;function Yt(){if(this.t<1)return 0;var t=this[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function et(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Kt(t){var e=m();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(r.ZERO)>0&&this.m.subTo(e,e),e}function Xt(t){var e=m();return t.copyTo(e),this.reduce(e),e}function $t(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=t[e]&32767,n=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,n,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Jt(t,e){t.squareTo(e),this.reduce(e)}function Wt(t,e,i){t.multiplyTo(e,i),this.reduce(i)}et.prototype.convert=Kt,et.prototype.revert=Xt,et.prototype.reduce=$t,et.prototype.mulTo=Wt,et.prototype.sqrTo=Jt;function Qt(){return(this.t>0?this[0]&1:this.s)==0}function te(t,e){if(t>4294967295||t<1)return r.ONE;var i=m(),n=m(),u=e.convert(this),l=q(t)-1;for(u.copyTo(i);--l>=0;)if(e.sqrTo(i,n),(t&1<<l)>0)e.mulTo(n,u,i);else{var y=i;i=n,n=y}return e.revert(i)}function ee(t,e){var i;return t<256||e.isEven()?i=new R(e):i=new et(e),this.exp(t,i)}r.prototype.copyTo=h,r.prototype.fromInt=o,r.prototype.fromString=s,r.prototype.clamp=g,r.prototype.dlShiftTo=H,r.prototype.drShiftTo=L,r.prototype.lShiftTo=U,r.prototype.rShiftTo=W,r.prototype.subTo=K,r.prototype.multiplyTo=nt,r.prototype.squareTo=st,r.prototype.divRemTo=ot,r.prototype.invDigit=Yt,r.prototype.isEven=Qt,r.prototype.exp=te,r.prototype.toString=I,r.prototype.negate=A,r.prototype.abs=C,r.prototype.compareTo=V,r.prototype.bitLength=O,r.prototype.mod=ft,r.prototype.modPowInt=ee,r.ZERO=x(0),r.ONE=x(1);function ie(){var t=m();return this.copyTo(t),t}function ne(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function re(){return this.t==0?this.s:this[0]<<24>>24}function se(){return this.t==0?this.s:this[0]<<16>>16}function oe(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function fe(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function he(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),n=x(i),u=m(),l=m(),y="";for(this.divRemTo(n,u,l);u.signum()>0;)y=(i+l.intValue()).toString(t).substr(1)+y,u.divRemTo(n,u,l);return l.intValue().toString(t)+y}function ue(t,e){this.fromInt(0),e==null&&(e=10);for(var i=this.chunkSize(e),n=Math.pow(e,i),u=!1,l=0,y=0,T=0;T<t.length;++T){var N=a(t,T);if(N<0){t.charAt(T)=="-"&&this.signum()==0&&(u=!0);continue}y=e*y+N,++l>=i&&(this.dMultiply(n),this.dAddOffset(y,0),l=0,y=0)}l>0&&(this.dMultiply(Math.pow(e,l)),this.dAddOffset(y,0)),u&&r.ZERO.subTo(this,this)}function ce(t,e,i){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(r.ONE.shiftLeft(t-1),xt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(r.ONE.shiftLeft(t-1),this);else{var n=new Array,u=t&7;n.length=(t>>3)+1,e.nextBytes(n),u>0?n[0]&=(1<<u)-1:n[0]=0,this.fromString(n,256)}}function le(){var t=this.t,e=new Array;e[0]=this.s;var i=this.DB-t*this.DB%8,n,u=0;if(t-- >0)for(i<this.DB&&(n=this[t]>>i)!=(this.s&this.DM)>>i&&(e[u++]=n|this.s<<this.DB-i);t>=0;)i<8?(n=(this[t]&(1<<i)-1)<<8-i,n|=this[--t]>>(i+=this.DB-8)):(n=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),(n&128)!=0&&(n|=-256),u==0&&(this.s&128)!=(n&128)&&++u,(u>0||n!=this.s)&&(e[u++]=n);return e}function ae(t){return this.compareTo(t)==0}function xe(t){return this.compareTo(t)<0?this:t}function pe(t){return this.compareTo(t)>0?this:t}function de(t,e,i){var n,u,l=Math.min(t.t,this.t);for(n=0;n<l;++n)i[n]=e(this[n],t[n]);if(t.t<this.t){for(u=t.s&this.DM,n=l;n<this.t;++n)i[n]=e(this[n],u);i.t=this.t}else{for(u=this.s&this.DM,n=l;n<t.t;++n)i[n]=e(u,t[n]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function ge(t,e){return t&e}function me(t){var e=m();return this.bitwiseTo(t,ge,e),e}function xt(t,e){return t|e}function ye(t){var e=m();return this.bitwiseTo(t,xt,e),e}function St(t,e){return t^e}function ve(t){var e=m();return this.bitwiseTo(t,St,e),e}function qt(t,e){return t&~e}function be(t){var e=m();return this.bitwiseTo(t,qt,e),e}function Te(){for(var t=m(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function we(t){var e=m();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Fe(t){var e=m();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Be(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function Se(){for(var t=0;t<this.t;++t)if(this[t]!=0)return t*this.DB+Be(this[t]);return this.s<0?this.t*this.DB:-1}function qe(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function De(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=qe(this[i]^e);return t}function Ie(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this[e]&1<<t%this.DB)!=0}function Re(t,e){var i=r.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}function Ee(t){return this.changeBit(t,xt)}function Ae(t){return this.changeBit(t,qt)}function Pe(t){return this.changeBit(t,St)}function Me(t,e){for(var i=0,n=0,u=Math.min(t.t,this.t);i<u;)n+=this[i]+t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n+=t[i],e[i++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[i++]=n:n<-1&&(e[i++]=this.DV+n),e.t=i,e.clamp()}function Ce(t){var e=m();return this.addTo(t,e),e}function Oe(t){var e=m();return this.subTo(t,e),e}function He(t){var e=m();return this.multiplyTo(t,e),e}function Ve(){var t=m();return this.squareTo(t),t}function Le(t){var e=m();return this.divRemTo(t,e,null),e}function Ne(t){var e=m();return this.divRemTo(t,null,e),e}function ze(t){var e=m(),i=m();return this.divRemTo(t,e,i),new Array(e,i)}function je(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function ke(t,e){if(t!=0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function rt(){}function Dt(t){return t}function Ze(t,e,i){t.multiplyTo(e,i)}function Ue(t,e){t.squareTo(e)}rt.prototype.convert=Dt,rt.prototype.revert=Dt,rt.prototype.mulTo=Ze,rt.prototype.sqrTo=Ue;function _e(t){return this.exp(t,new rt)}function Ge(t,e,i){var n=Math.min(this.t+t.t,e);for(i.s=0,i.t=n;n>0;)i[--n]=0;var u;for(u=i.t-this.t;n<u;++n)i[n+this.t]=this.am(0,t[n],i,n,0,this.t);for(u=Math.min(t.t,e);n<u;++n)this.am(0,t[n],i,n,0,e-n);i.clamp()}function Ye(t,e,i){--e;var n=i.t=this.t+t.t-e;for(i.s=0;--n>=0;)i[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)i[this.t+n-e]=this.am(e-n,t[n],i,0,0,this.t+n-e);i.clamp(),i.drShiftTo(1,i)}function it(t){this.r2=m(),this.q3=m(),r.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Ke(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=m();return t.copyTo(e),this.reduce(e),e}function Xe(t){return t}function $e(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Je(t,e){t.squareTo(e),this.reduce(e)}function We(t,e,i){t.multiplyTo(e,i),this.reduce(i)}it.prototype.convert=Ke,it.prototype.revert=Xe,it.prototype.reduce=$e,it.prototype.mulTo=We,it.prototype.sqrTo=Je;function Qe(t,e){var i=t.bitLength(),n,u=x(1),l;if(i<=0)return u;i<18?n=1:i<48?n=3:i<144?n=4:i<768?n=5:n=6,i<8?l=new R(e):e.isEven()?l=new it(e):l=new et(e);var y=new Array,T=3,N=n-1,j=(1<<n)-1;if(y[1]=l.convert(this),n>1){var Y=m();for(l.sqrTo(y[1],Y);T<=j;)y[T]=m(),l.mulTo(Y,y[T-2],y[T]),T+=2}var G=t.t-1,Q,ut=!0,$=m(),J;for(i=q(t[G])-1;G>=0;){for(i>=N?Q=t[G]>>i-N&j:(Q=(t[G]&(1<<i+1)-1)<<N-i,G>0&&(Q|=t[G-1]>>this.DB+i-N)),T=n;(Q&1)==0;)Q>>=1,--T;if((i-=T)<0&&(i+=this.DB,--G),ut)y[Q].copyTo(u),ut=!1;else{for(;T>1;)l.sqrTo(u,$),l.sqrTo($,u),T-=2;T>0?l.sqrTo(u,$):(J=u,u=$,$=J),l.mulTo($,y[Q],u)}for(;G>=0&&(t[G]&1<<i)==0;)l.sqrTo(u,$),J=u,u=$,$=J,--i<0&&(i=this.DB-1,--G)}return l.revert(u)}function ti(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var n=e;e=i,i=n}var u=e.getLowestSetBit(),l=i.getLowestSetBit();if(l<0)return e;for(u<l&&(l=u),l>0&&(e.rShiftTo(l,e),i.rShiftTo(l,i));e.signum()>0;)(u=e.getLowestSetBit())>0&&e.rShiftTo(u,e),(u=i.getLowestSetBit())>0&&i.rShiftTo(u,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return l>0&&i.lShiftTo(l,i),i}function ei(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(e==0)i=this[0]%t;else for(var n=this.t-1;n>=0;--n)i=(e*i+this[n])%t;return i}function ii(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return r.ZERO;for(var i=t.clone(),n=this.clone(),u=x(1),l=x(0),y=x(0),T=x(1);i.signum()!=0;){for(;i.isEven();)i.rShiftTo(1,i),e?((!u.isEven()||!l.isEven())&&(u.addTo(this,u),l.subTo(t,l)),u.rShiftTo(1,u)):l.isEven()||l.subTo(t,l),l.rShiftTo(1,l);for(;n.isEven();)n.rShiftTo(1,n),e?((!y.isEven()||!T.isEven())&&(y.addTo(this,y),T.subTo(t,T)),y.rShiftTo(1,y)):T.isEven()||T.subTo(t,T),T.rShiftTo(1,T);i.compareTo(n)>=0?(i.subTo(n,i),e&&u.subTo(y,u),l.subTo(T,l)):(n.subTo(i,n),e&&y.subTo(u,y),T.subTo(l,T))}if(n.compareTo(r.ONE)!=0)return r.ZERO;if(T.compareTo(t)>=0)return T.subtract(t);if(T.signum()<0)T.addTo(t,T);else return T;return T.signum()<0?T.add(t):T}var Z=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ni=(1<<26)/Z[Z.length-1];function ri(t){var e,i=this.abs();if(i.t==1&&i[0]<=Z[Z.length-1]){for(e=0;e<Z.length;++e)if(i[0]==Z[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<Z.length;){for(var n=Z[e],u=e+1;u<Z.length&&n<ni;)n*=Z[u++];for(n=i.modInt(n);e<u;)if(n%Z[e++]==0)return!1}return i.millerRabin(t)}function si(t){var e=this.subtract(r.ONE),i=e.getLowestSetBit();if(i<=0)return!1;var n=e.shiftRight(i);t=t+1>>1,t>Z.length&&(t=Z.length);for(var u=m(),l=0;l<t;++l){u.fromInt(Z[Math.floor(Math.random()*Z.length)]);var y=u.modPow(n,this);if(y.compareTo(r.ONE)!=0&&y.compareTo(e)!=0){for(var T=1;T++<i&&y.compareTo(e)!=0;)if(y=y.modPowInt(2,this),y.compareTo(r.ONE)==0)return!1;if(y.compareTo(e)!=0)return!1}}return!0}r.prototype.chunkSize=oe,r.prototype.toRadix=he,r.prototype.fromRadix=ue,r.prototype.fromNumber=ce,r.prototype.bitwiseTo=de,r.prototype.changeBit=Re,r.prototype.addTo=Me,r.prototype.dMultiply=je,r.prototype.dAddOffset=ke,r.prototype.multiplyLowerTo=Ge,r.prototype.multiplyUpperTo=Ye,r.prototype.modInt=ei,r.prototype.millerRabin=si,r.prototype.clone=ie,r.prototype.intValue=ne,r.prototype.byteValue=re,r.prototype.shortValue=se,r.prototype.signum=fe,r.prototype.toByteArray=le,r.prototype.equals=ae,r.prototype.min=xe,r.prototype.max=pe,r.prototype.and=me,r.prototype.or=ye,r.prototype.xor=ve,r.prototype.andNot=be,r.prototype.not=Te,r.prototype.shiftLeft=we,r.prototype.shiftRight=Fe,r.prototype.getLowestSetBit=Se,r.prototype.bitCount=De,r.prototype.testBit=Ie,r.prototype.setBit=Ee,r.prototype.clearBit=Ae,r.prototype.flipBit=Pe,r.prototype.add=Ce,r.prototype.subtract=Oe,r.prototype.multiply=He,r.prototype.divide=Le,r.prototype.remainder=Ne,r.prototype.divideAndRemainder=ze,r.prototype.modPow=Qe,r.prototype.modInverse=ii,r.prototype.pow=_e,r.prototype.gcd=ti,r.prototype.isProbablePrime=ri,r.prototype.square=Ve,r.prototype.Barrett=it;var ht,_,z;function oi(t){_[z++]^=t&255,_[z++]^=t>>8&255,_[z++]^=t>>16&255,_[z++]^=t>>24&255,z>=dt&&(z-=dt)}function It(){oi(new Date().getTime())}if(_==null){_=new Array,z=0;var X;if(typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var Rt=new Uint8Array(32);for(window.crypto.getRandomValues(Rt),X=0;X<32;++X)_[z++]=Rt[X]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var Et=window.crypto.random(32);for(X=0;X<Et.length;++X)_[z++]=Et.charCodeAt(X)&255}}for(;z<dt;)X=Math.floor(65536*Math.random()),_[z++]=X>>>8,_[z++]=X&255;z=0,It()}function fi(){if(ht==null){for(It(),ht=li(),ht.init(_),z=0;z<_.length;++z)_[z]=0;z=0}return ht.next()}function hi(t){var e;for(e=0;e<t.length;++e)t[e]=fi()}function At(){}At.prototype.nextBytes=hi;function pt(){this.i=0,this.j=0,this.S=new Array}function ui(t){var e,i,n;for(e=0;e<256;++e)this.S[e]=e;for(i=0,e=0;e<256;++e)i=i+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[i],this.S[i]=n;this.i=0,this.j=0}function ci(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}pt.prototype.init=ui,pt.prototype.next=ci;function li(){return new pt}var dt=256;v.exports={default:r,BigInteger:r,SecureRandom:At}}).call(ai)}(lt)),lt.exports}var mt,Mt;function xi(){if(Mt)return mt;Mt=1;const{BigInteger:v}=at();function k(w){let p=w.toString(16);if(p[0]!=="-")p.length%2===1?p="0"+p:p.match(/^[0-7]/)||(p="00"+p);else{p=p.substr(1);let d=p.length;d%2===1?d+=1:p.match(/^[0-7]/)||(d+=2);let F="";for(let B=0;B<d;B++)F+="f";F=new v(F,16),p=F.xor(w).add(v.ONE),p=p.toString(16).replace(/^-/,"")}return p}class D{constructor(){this.tlv=null,this.t="00",this.l="00",this.v=""}getEncodedHex(){return this.tlv||(this.v=this.getValue(),this.l=this.getLength(),this.tlv=this.t+this.l+this.v),this.tlv}getLength(){const p=this.v.length/2;let d=p.toString(16);return d.length%2===1&&(d="0"+d),p<128?d:(128+d.length/2).toString(16)+d}getValue(){return""}}class b extends D{constructor(p){super(),this.t="02",p&&(this.v=k(p))}getValue(){return this.v}}class M extends D{constructor(p){super(),this.t="30",this.asn1Array=p}getValue(){return this.v=this.asn1Array.map(p=>p.getEncodedHex()).join(""),this.v}}function r(w,p){return+w[p+2]<8?1:+w.substr(p+2,2)&128}function m(w,p){const d=r(w,p),F=w.substr(p+2,d*2);return F?(+F[0]<8?new v(F,16):new v(F.substr(2),16)).intValue():-1}function c(w,p){const d=r(w,p);return p+(d+1)*2}return mt={encodeDer(w,p){const d=new b(w),F=new b(p);return new M([d,F]).getEncodedHex()},decodeDer(w){const p=c(w,0),d=c(w,p),F=m(w,p),B=w.substr(d,F*2),E=d+B.length,S=c(w,E),P=m(w,E),f=w.substr(S,P*2),a=new v(B,16),h=new v(f,16);return{r:a,s:h}}},mt}var yt,Ct;function pi(){if(Ct)return yt;Ct=1;const{BigInteger:v}=at(),k=new v("2"),D=new v("3");class b{constructor(c,w){this.x=w,this.q=c}equals(c){return c===this?!0:this.q.equals(c.q)&&this.x.equals(c.x)}toBigInteger(){return this.x}negate(){return new b(this.q,this.x.negate().mod(this.q))}add(c){return new b(this.q,this.x.add(c.toBigInteger()).mod(this.q))}subtract(c){return new b(this.q,this.x.subtract(c.toBigInteger()).mod(this.q))}multiply(c){return new b(this.q,this.x.multiply(c.toBigInteger()).mod(this.q))}divide(c){return new b(this.q,this.x.multiply(c.toBigInteger().modInverse(this.q)).mod(this.q))}square(){return new b(this.q,this.x.square().mod(this.q))}}class M{constructor(c,w,p,d){this.curve=c,this.x=w,this.y=p,this.z=d??v.ONE,this.zinv=null}getX(){return this.zinv===null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}getY(){return this.zinv===null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}equals(c){return c===this?!0:this.isInfinity()?c.isInfinity():c.isInfinity()?this.isInfinity():c.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(c.z)).mod(this.curve.q).equals(v.ZERO)?c.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(c.z)).mod(this.curve.q).equals(v.ZERO):!1}isInfinity(){return this.x===null&&this.y===null?!0:this.z.equals(v.ZERO)&&!this.y.toBigInteger().equals(v.ZERO)}negate(){return new M(this.curve,this.x,this.y.negate(),this.z)}add(c){if(this.isInfinity())return c;if(c.isInfinity())return this;const w=this.x.toBigInteger(),p=this.y.toBigInteger(),d=this.z,F=c.x.toBigInteger(),B=c.y.toBigInteger(),E=c.z,S=this.curve.q,P=w.multiply(E).mod(S),f=F.multiply(d).mod(S),a=P.subtract(f),h=p.multiply(E).mod(S),o=B.multiply(d).mod(S),x=h.subtract(o);if(v.ZERO.equals(a))return v.ZERO.equals(x)?this.twice():this.curve.infinity;const s=P.add(f),g=d.multiply(E).mod(S),I=a.square().mod(S),A=a.multiply(I).mod(S),C=g.multiply(x.square()).subtract(s.multiply(I)).mod(S),V=a.multiply(C).mod(S),q=x.multiply(I.multiply(P).subtract(C)).subtract(h.multiply(A)).mod(S),O=A.multiply(g).mod(S);return new M(this.curve,this.curve.fromBigInteger(V),this.curve.fromBigInteger(q),O)}twice(){if(this.isInfinity())return this;if(!this.y.toBigInteger().signum())return this.curve.infinity;const c=this.x.toBigInteger(),w=this.y.toBigInteger(),p=this.z,d=this.curve.q,F=this.curve.a.toBigInteger(),B=c.square().multiply(D).add(F.multiply(p.square())).mod(d),E=w.shiftLeft(1).multiply(p).mod(d),S=w.square().mod(d),P=S.multiply(c).multiply(p).mod(d),f=E.square().mod(d),a=B.square().subtract(P.shiftLeft(3)).mod(d),h=E.multiply(a).mod(d),o=B.multiply(P.shiftLeft(2).subtract(a)).subtract(f.shiftLeft(1).multiply(S)).mod(d),x=E.multiply(f).mod(d);return new M(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(o),x)}multiply(c){if(this.isInfinity())return this;if(!c.signum())return this.curve.infinity;const w=c.multiply(D),p=this.negate();let d=this;for(let F=w.bitLength()-2;F>0;F--){d=d.twice();const B=w.testBit(F),E=c.testBit(F);B!==E&&(d=d.add(B?this:p))}return d}}class r{constructor(c,w,p){this.q=c,this.a=this.fromBigInteger(w),this.b=this.fromBigInteger(p),this.infinity=new M(this,null,null)}equals(c){return c===this?!0:this.q.equals(c.q)&&this.a.equals(c.a)&&this.b.equals(c.b)}fromBigInteger(c){return new b(this.q,c)}decodePointHex(c){switch(parseInt(c.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:const w=this.fromBigInteger(new v(c.substr(2),16));let p=this.fromBigInteger(w.multiply(w.square()).add(w.multiply(this.a)).add(this.b).toBigInteger().modPow(this.q.divide(new v("4")).add(v.ONE),this.q));return p.toBigInteger().mod(k).equals(new v(c.substr(0,2),16).subtract(k))||(p=p.negate()),new M(this,w,p);case 4:case 6:case 7:const d=(c.length-2)/2,F=c.substr(2,d),B=c.substr(d+2,d);return new M(this,this.fromBigInteger(new v(F,16)),this.fromBigInteger(new v(B,16)));default:return null}}}return yt={ECPointFp:M,ECCurveFp:r},yt}var vt,Ot;function di(){if(Ot)return vt;Ot=1;const{BigInteger:v,SecureRandom:k}=at(),{ECCurveFp:D}=pi(),b=new k,{curve:M,G:r,n:m}=w();function c(){return M}function w(){const h=new v("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),o=new v("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),x=new v("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16),s=new D(h,o,x),A=s.decodePointHex("04"+"32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7"+"BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0"),C=new v("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16);return{curve:s,G:A,n:C}}function p(h,o,x){const g=(h?new v(h,o,x):new v(m.bitLength(),b)).mod(m.subtract(v.ONE)).add(v.ONE),I=B(g.toString(16),64),A=r.multiply(g),C=B(A.getX().toBigInteger().toString(16),64),V=B(A.getY().toBigInteger().toString(16),64),q="04"+C+V;return{privateKey:I,publicKey:q}}function d(h){if(h.length!==130)throw new Error("Invalid public key to compress");const o=(h.length-2)/2,x=h.substr(2,o),s=new v(h.substr(o+2,o),16);let g="03";return s.mod(new v("2")).equals(v.ZERO)&&(g="02"),g+x}function F(h){h=unescape(encodeURIComponent(h));const o=h.length,x=[];for(let g=0;g<o;g++)x[g>>>2]|=(h.charCodeAt(g)&255)<<24-g%4*8;const s=[];for(let g=0;g<o;g++){const I=x[g>>>2]>>>24-g%4*8&255;s.push((I>>>4).toString(16)),s.push((I&15).toString(16))}return s.join("")}function B(h,o){return h.length>=o?h:new Array(o-h.length+1).join("0")+h}function E(h){return h.map(o=>(o=o.toString(16),o.length===1?"0"+o:o)).join("")}function S(h){const o=[];let x=0;for(let s=0;s<h.length*2;s+=2)o[s>>>3]|=parseInt(h[x],10)<<24-s%8*4,x++;try{const s=[];for(let g=0;g<h.length;g++){const I=o[g>>>2]>>>24-g%4*8&255;s.push(String.fromCharCode(I))}return decodeURIComponent(escape(s.join("")))}catch{throw new Error("Malformed UTF-8 data")}}function P(h){const o=[];let x=h.length;x%2!==0&&(h=B(h,x+1)),x=h.length;for(let s=0;s<x;s+=2)o.push(parseInt(h.substr(s,2),16));return o}function f(h){const o=M.decodePointHex(h);if(!o)return!1;const x=o.getX();return o.getY().square().equals(x.multiply(x.square()).add(x.multiply(M.a)).add(M.b))}function a(h,o){const x=M.decodePointHex(h);if(!x)return!1;const s=M.decodePointHex(o);return s?x.equals(s):!1}return vt={getGlobalCurve:c,generateEcparam:w,generateKeyPairHex:p,compressPublicKeyHex:d,utf8ToHex:F,leftPad:B,arrayToHex:E,arrayToUtf8:S,hexToArray:P,verifyPublicKey:f,comparePublicKeyHex:a},vt}var bt,Ht;function jt(){if(Ht)return bt;Ht=1;const v=new Uint32Array(68),k=new Uint32Array(64);function D(F,B){const E=B&31;return F<<E|F>>>32-E}function b(F,B){const E=[];for(let S=F.length-1;S>=0;S--)E[S]=(F[S]^B[S])&255;return E}function M(F){return F^D(F,9)^D(F,17)}function r(F){return F^D(F,15)^D(F,23)}function m(F){let B=F.length*8,E=B%512;E=E>=448?512-E%448-1:448-E-1;const S=new Array((E-7)/8),P=new Array(8);for(let s=0,g=S.length;s<g;s++)S[s]=0;for(let s=0,g=P.length;s<g;s++)P[s]=0;B=B.toString(2);for(let s=7;s>=0;s--)if(B.length>8){const g=B.length-8;P[s]=parseInt(B.substr(g),2),B=B.substr(0,g)}else B.length>0&&(P[s]=parseInt(B,2),B="");const f=new Uint8Array([...F,128,...S,...P]),a=new DataView(f.buffer,0),h=f.length/64,o=new Uint32Array([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214]);for(let s=0;s<h;s++){v.fill(0),k.fill(0);const g=16*s;for(let R=0;R<16;R++)v[R]=a.getUint32((g+R)*4,!1);for(let R=16;R<68;R++)v[R]=r(v[R-16]^v[R-9]^D(v[R-3],15))^D(v[R-13],7)^v[R-6];for(let R=0;R<64;R++)k[R]=v[R]^v[R+4];const I=2043430169,A=2055708042;let C=o[0],V=o[1],q=o[2],O=o[3],H=o[4],L=o[5],U=o[6],W=o[7],K,nt,st,ot,ft;for(let R=0;R<64;R++)ft=R>=0&&R<=15?I:A,K=D(D(C,12)+H+D(ft,R),7),nt=K^D(C,12),st=(R>=0&&R<=15?C^V^q:C&V|C&q|V&q)+O+nt+k[R],ot=(R>=0&&R<=15?H^L^U:H&L|~H&U)+W+K+v[R],O=q,q=D(V,9),V=C,C=st,W=U,U=D(L,19),L=H,H=M(ot);o[0]^=C,o[1]^=V,o[2]^=q,o[3]^=O,o[4]^=H,o[5]^=L,o[6]^=U,o[7]^=W}const x=[];for(let s=0,g=o.length;s<g;s++){const I=o[s];x.push((I&4278190080)>>>24,(I&16711680)>>>16,(I&65280)>>>8,I&255)}return x}const c=64,w=new Uint8Array(c),p=new Uint8Array(c);for(let F=0;F<c;F++)w[F]=54,p[F]=92;function d(F,B){for(B.length>c&&(B=m(B));B.length<c;)B.push(0);const E=b(B,w),S=b(B,p),P=m([...E,...F]);return m([...S,...P])}return bt={sm3:m,hmac:d},bt}var Tt,Vt;function gi(){if(Vt)return Tt;Vt=1;const{BigInteger:v}=at(),{encodeDer:k,decodeDer:D}=xi(),b=di(),M=jt().sm3,{G:r,curve:m,n:c}=b.generateEcparam(),w=0;function p(f,a,h=1){f=typeof f=="string"?b.hexToArray(b.utf8ToHex(f)):Array.prototype.slice.call(f),a=b.getGlobalCurve().decodePointHex(a);const o=b.generateKeyPairHex(),x=new v(o.privateKey,16);let s=o.publicKey;s.length>128&&(s=s.substr(s.length-128));const g=a.multiply(x),I=b.hexToArray(b.leftPad(g.getX().toBigInteger().toRadix(16),64)),A=b.hexToArray(b.leftPad(g.getY().toBigInteger().toRadix(16),64)),C=b.arrayToHex(M([].concat(I,f,A)));let V=1,q=0,O=[];const H=[].concat(I,A),L=()=>{O=M([...H,V>>24&255,V>>16&255,V>>8&255,V&255]),V++,q=0};L();for(let W=0,K=f.length;W<K;W++)q===O.length&&L(),f[W]^=O[q++]&255;const U=b.arrayToHex(f);return h===w?s+U+C:s+C+U}function d(f,a,h=1,{output:o="string"}={}){a=new v(a,16);let x=f.substr(128,64),s=f.substr(192);h===w&&(x=f.substr(f.length-64),s=f.substr(128,f.length-128-64));const g=b.hexToArray(s),A=b.getGlobalCurve().decodePointHex("04"+f.substr(0,128)).multiply(a),C=b.hexToArray(b.leftPad(A.getX().toBigInteger().toRadix(16),64)),V=b.hexToArray(b.leftPad(A.getY().toBigInteger().toRadix(16),64));let q=1,O=0,H=[];const L=[].concat(C,V),U=()=>{H=M([...L,q>>24&255,q>>16&255,q>>8&255,q&255]),q++,O=0};U();for(let K=0,nt=g.length;K<nt;K++)O===H.length&&U(),g[K]^=H[O++]&255;return b.arrayToHex(M([].concat(C,g,V)))===x.toLowerCase()?o==="array"?g:b.arrayToUtf8(g):o==="array"?[]:""}function F(f,a,{pointPool:h,der:o,hash:x,publicKey:s,userId:g}={}){let I=typeof f=="string"?b.utf8ToHex(f):b.arrayToHex(f);x&&(s=s||S(a),I=E(I,s,g));const A=new v(a,16),C=new v(I,16);let V=null,q=null,O=null;do{do{let H;h&&h.length?H=h.pop():H=P(),V=H.k,q=C.add(H.x1).mod(c)}while(q.equals(v.ZERO)||q.add(V).equals(c));O=A.add(v.ONE).modInverse(c).multiply(V.subtract(q.multiply(A))).mod(c)}while(O.equals(v.ZERO));return o?k(q,O):b.leftPad(q.toString(16),64)+b.leftPad(O.toString(16),64)}function B(f,a,h,{der:o,hash:x,userId:s}={}){let g=typeof f=="string"?b.utf8ToHex(f):b.arrayToHex(f);x&&(g=E(g,h,s));let I,A;if(o){const L=D(a);I=L.r,A=L.s}else I=new v(a.substring(0,64),16),A=new v(a.substring(64),16);const C=m.decodePointHex(h),V=new v(g,16),q=I.add(A).mod(c);if(q.equals(v.ZERO))return!1;const O=r.multiply(A).add(C.multiply(q)),H=V.add(O.getX().toBigInteger()).mod(c);return I.equals(H)}function E(f,a,h="1234567812345678"){h=b.utf8ToHex(h);const o=b.leftPad(r.curve.a.toBigInteger().toRadix(16),64),x=b.leftPad(r.curve.b.toBigInteger().toRadix(16),64),s=b.leftPad(r.getX().toBigInteger().toRadix(16),64),g=b.leftPad(r.getY().toBigInteger().toRadix(16),64);let I,A;if(a.length===128)I=a.substr(0,64),A=a.substr(64,64);else{const O=r.curve.decodePointHex(a);I=b.leftPad(O.getX().toBigInteger().toRadix(16),64),A=b.leftPad(O.getY().toBigInteger().toRadix(16),64)}const C=b.hexToArray(h+o+x+s+g+I+A),V=h.length*4;C.unshift(V&255),C.unshift(V>>8&255);const q=M(C);return b.arrayToHex(M(q.concat(b.hexToArray(f))))}function S(f){const a=r.multiply(new v(f,16)),h=b.leftPad(a.getX().toBigInteger().toString(16),64),o=b.leftPad(a.getY().toBigInteger().toString(16),64);return"04"+h+o}function P(){const f=b.generateKeyPairHex(),a=m.decodePointHex(f.publicKey);return f.k=new v(f.privateKey,16),f.x1=a.getX().toBigInteger(),f}return Tt={generateKeyPairHex:b.generateKeyPairHex,compressPublicKeyHex:b.compressPublicKeyHex,comparePublicKeyHex:b.comparePublicKeyHex,doEncrypt:p,doDecrypt:d,doSignature:F,doVerifySignature:B,getPublicKeyFromPrivateKey:S,getPoint:P,verifyPublicKey:b.verifyPublicKey},Tt}var wt,Lt;function mi(){if(Lt)return wt;Lt=1;const{sm3:v,hmac:k}=jt();function D(m,c){return m.length>=c?m:new Array(c-m.length+1).join("0")+m}function b(m){return m.map(c=>(c=c.toString(16),c.length===1?"0"+c:c)).join("")}function M(m){const c=[];let w=m.length;w%2!==0&&(m=D(m,w+1)),w=m.length;for(let p=0;p<w;p+=2)c.push(parseInt(m.substr(p,2),16));return c}function r(m){const c=[];for(let w=0,p=m.length;w<p;w++){const d=m.codePointAt(w);if(d<=127)c.push(d);else if(d<=2047)c.push(192|d>>>6),c.push(128|d&63);else if(d<=55295||d>=57344&&d<=65535)c.push(224|d>>>12),c.push(128|d>>>6&63),c.push(128|d&63);else if(d>=65536&&d<=1114111)w++,c.push(240|d>>>18&28),c.push(128|d>>>12&63),c.push(128|d>>>6&63),c.push(128|d&63);else throw c.push(d),new Error("input is not supported")}return c}return wt=function(m,c){if(m=typeof m=="string"?r(m):Array.prototype.slice.call(m),c){if((c.mode||"hmac")!=="hmac")throw new Error("invalid mode");let p=c.key;if(!p)throw new Error("invalid key");return p=typeof p=="string"?M(p):Array.prototype.slice.call(p),b(k(m,p))}return b(v(m))},wt}var Ft,Nt;function yi(){if(Nt)return Ft;Nt=1;const v=0,k=32,D=16,b=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],M=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];function r(f){const a=[];for(let h=0,o=f.length;h<o;h+=2)a.push(parseInt(f.substr(h,2),16));return a}function m(f){return f.map(a=>(a=a.toString(16),a.length===1?"0"+a:a)).join("")}function c(f){const a=[];for(let h=0,o=f.length;h<o;h++){const x=f.codePointAt(h);if(x<=127)a.push(x);else if(x<=2047)a.push(192|x>>>6),a.push(128|x&63);else if(x<=55295||x>=57344&&x<=65535)a.push(224|x>>>12),a.push(128|x>>>6&63),a.push(128|x&63);else if(x>=65536&&x<=1114111)h++,a.push(240|x>>>18&28),a.push(128|x>>>12&63),a.push(128|x>>>6&63),a.push(128|x&63);else throw a.push(x),new Error("input is not supported")}return a}function w(f){const a=[];for(let h=0,o=f.length;h<o;h++)f[h]>=240&&f[h]<=247?(a.push(String.fromCodePoint(((f[h]&7)<<18)+((f[h+1]&63)<<12)+((f[h+2]&63)<<6)+(f[h+3]&63))),h+=3):f[h]>=224&&f[h]<=239?(a.push(String.fromCodePoint(((f[h]&15)<<12)+((f[h+1]&63)<<6)+(f[h+2]&63))),h+=2):f[h]>=192&&f[h]<=223?(a.push(String.fromCodePoint(((f[h]&31)<<6)+(f[h+1]&63))),h++):a.push(String.fromCodePoint(f[h]));return a.join("")}function p(f,a){const h=a&31;return f<<h|f>>>32-h}function d(f){return(b[f>>>24&255]&255)<<24|(b[f>>>16&255]&255)<<16|(b[f>>>8&255]&255)<<8|b[f&255]&255}function F(f){return f^p(f,2)^p(f,10)^p(f,18)^p(f,24)}function B(f){return f^p(f,13)^p(f,23)}function E(f,a,h){const o=new Array(4),x=new Array(4);for(let s=0;s<4;s++)x[0]=f[4*s]&255,x[1]=f[4*s+1]&255,x[2]=f[4*s+2]&255,x[3]=f[4*s+3]&255,o[s]=x[0]<<24|x[1]<<16|x[2]<<8|x[3];for(let s=0,g;s<32;s+=4)g=o[1]^o[2]^o[3]^h[s+0],o[0]^=F(d(g)),g=o[2]^o[3]^o[0]^h[s+1],o[1]^=F(d(g)),g=o[3]^o[0]^o[1]^h[s+2],o[2]^=F(d(g)),g=o[0]^o[1]^o[2]^h[s+3],o[3]^=F(d(g));for(let s=0;s<16;s+=4)a[s]=o[3-s/4]>>>24&255,a[s+1]=o[3-s/4]>>>16&255,a[s+2]=o[3-s/4]>>>8&255,a[s+3]=o[3-s/4]&255}function S(f,a,h){const o=new Array(4),x=new Array(4);for(let s=0;s<4;s++)x[0]=f[0+4*s]&255,x[1]=f[1+4*s]&255,x[2]=f[2+4*s]&255,x[3]=f[3+4*s]&255,o[s]=x[0]<<24|x[1]<<16|x[2]<<8|x[3];o[0]^=2746333894,o[1]^=1453994832,o[2]^=1736282519,o[3]^=2993693404;for(let s=0,g;s<32;s+=4)g=o[1]^o[2]^o[3]^M[s+0],a[s+0]=o[0]^=B(d(g)),g=o[2]^o[3]^o[0]^M[s+1],a[s+1]=o[1]^=B(d(g)),g=o[3]^o[0]^o[1]^M[s+2],a[s+2]=o[2]^=B(d(g)),g=o[0]^o[1]^o[2]^M[s+3],a[s+3]=o[3]^=B(d(g));if(h===v)for(let s=0,g;s<16;s++)g=a[s],a[s]=a[31-s],a[31-s]=g}function P(f,a,h,{padding:o="pkcs#7",mode:x,iv:s=[],output:g="string"}={}){if(x==="cbc"&&(typeof s=="string"&&(s=r(s)),s.length!==128/8))throw new Error("iv is invalid");if(typeof a=="string"&&(a=r(a)),a.length!==128/8)throw new Error("key is invalid");if(typeof f=="string"?h!==v?f=c(f):f=r(f):f=[...f],(o==="pkcs#5"||o==="pkcs#7")&&h!==v){const O=D-f.length%D;for(let H=0;H<O;H++)f.push(O)}const I=new Array(k);S(a,I,h);const A=[];let C=s,V=f.length,q=0;for(;V>=D;){const O=f.slice(q,q+16),H=new Array(16);if(x==="cbc")for(let L=0;L<D;L++)h!==v&&(O[L]^=C[L]);E(O,H,I);for(let L=0;L<D;L++)x==="cbc"&&h===v&&(H[L]^=C[L]),A[q+L]=H[L];x==="cbc"&&(h!==v?C=H:C=O),V-=D,q+=D}if((o==="pkcs#5"||o==="pkcs#7")&&h===v){const O=A.length,H=A[O-1];for(let L=1;L<=H;L++)if(A[O-L]!==H)throw new Error("padding is invalid");A.splice(O-H,H)}return g!=="array"?h!==v?m(A):w(A):A}return Ft={encrypt(f,a,h){return P(f,a,1,h)},decrypt(f,a,h){return P(f,a,0,h)}},Ft}var Bt,zt;function vi(){return zt||(zt=1,Bt={sm2:gi(),sm3:mi(),sm4:yi()}),Bt}var bi=vi();export{bi as s};
