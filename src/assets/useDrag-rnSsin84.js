import{u as y}from"./dataview-q4Jj-tHZ.js";import{E as S}from"./dataviewTypes-DjJw5iW5.js";import{l as X}from"./lodash-buJ1Dk2D.js";import{a6 as A}from"./index-BGwiQ_ZP.js";const t=y(),b=()=>({mouseClickHandle:(s,o)=>{if(s.preventDefault(),s.stopPropagation(),!o.status.lock&&s.ctrlKey)if(t.dataviewState.targetChart.selectId.includes(o.id)){const p=t.dataviewState.targetChart.selectId.filter(m=>m!==o.id);t.setTargetSelectChart(p)}else t.setTargetSelectChart(o.id,!0)},mouseenterHandle:(s,o)=>{s.preventDefault(),s.stopPropagation(),t.getEditCanvas.isSelect||t.setTargetHoverChart(o.id)},mouseleaveHandle:(s,o)=>{s.preventDefault(),s.stopPropagation(),t.setTargetHoverChart(void 0)},mousedownHandleUnStop:(s,o)=>{o?t.setTargetSelectChart(o.id):t.setTargetSelectChart(void 0)},mousedownHandle:(s,o)=>{if(s.preventDefault(),s.stopPropagation(),o.status.lock)return;t.setTargetSelectChart(o.id);const p=t.getEditCanvas.scale,m=t.getEditCanvasConfig.width,x=t.getEditCanvasConfig.height,i=new Map;t.getTargetChart.selectId.forEach(e=>{const r=t.fetchTargetIndex(e);if(r!==-1){const{x:d,y:a,w:n,h:l}=A(t.getComponentList[r]).attr;i.set(e,{x:d,y:a,w:n,h:l})}});const T=s.screenX,h=s.screenY,u=[];t.getTargetChart.selectId.forEach(e=>{if(!i.has(e))return;const r=t.fetchTargetIndex(e);u.push(X.cloneDeep(t.getComponentList[r]))});const C=X.throttle(e=>{t.setEditCanvas(S.IS_DRAG,!0),t.setMousePosition(e.screenX,e.screenY);const r=(e.screenX-T)/p,d=(e.screenY-h)/p;t.getTargetChart.selectId.forEach(a=>{if(!i.has(a))return;const n=t.fetchTargetIndex(a),{x:l,y:P,w:M,h:D}=i.get(a),L=t.getComponentList[n];let g=Math.round(l+r),v=Math.round(P+d);const f=50;g=g<-M+f?-M+f:g,v=v<-D+f?-D+f:v,g=g>m-f?m-f:g,v=v>x-f?x-f:v,L&&(L.attr=Object.assign(L.attr,{x:g,y:v}))})},20),H=()=>{try{t.setMousePosition(0,0,0,0),t.setEditCanvas(S.IS_DRAG,!1),u.length&&t.getTargetChart.selectId.forEach(e=>{if(!i.has(e))return;const r=t.fetchTargetIndex(e),d=t.getComponentList[r];u.forEach(n=>{n.id===e&&(n.attr=Object.assign(n.attr,{offsetX:d.attr.x-n.attr.x,offsetY:d.attr.y-n.attr.y}))});const a=u.filter(n=>n.attr.offsetX!=0&&n.attr.offsetY!=0);a.length&&t.moveComponentList(a)}),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",H)}catch(e){console.log(e)}};document.addEventListener("mousemove",C),document.addEventListener("mouseup",H)}}),W=(E,w,c)=>{E.stopPropagation(),E.preventDefault(),t.setEditCanvas(S.IS_DRAG,!0);const I=t.getEditCanvas.scale,Y=c.x,s=c.y,o=c.w,p=c.h,m=E.screenX,x=E.screenY;t.setMousePosition(m,x);const i=X.throttle(h=>{t.setMousePosition(h.screenX,h.screenY);const u=Math.round((h.screenX-m)/I),C=Math.round((h.screenY-x)/I),H=/t/.test(w),e=/l/.test(w),r=/r/.test(w),d=/b/.test(w),a=o+(e?-u:r?u:0),n=p+(H?-C:d?C:0),l=50;c.w=a>l?a:l,c.h=n>l?n:l,c.x=Y+(e?u:0),c.y=s+(H?C:0)},20),T=h=>{t.setEditCanvas(S.IS_DRAG,!1),t.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",T)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",T)};export{W as a,b as u};
