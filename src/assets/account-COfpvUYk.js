import{d as q,i as F,r as C,o as N,O as R,c as T,e,w as a,ag as K,m as U,l as L,n as h,f as P,a as w,S as V,p as j,ah as M,I as p,a3 as u,ai as E,aj as v,ak as d,al as Y}from"./index-BGwiQ_ZP.js";import{s as z}from"./index-0n4paoV3.js";import{F as G,_ as H}from"./index-C3-0t2lO.js";import{I as J,a as Q}from"./index-BwLVAfvf.js";import{_ as W,a as X}from"./index-4yq-Tlp0.js";import{B as Z}from"./index-_DVN_kvK.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DzzgRnZQ.js";import"./_getTag-BRywsnft.js";import"./zoom-CXqzwkKe.js";import"./vnode-BaoCyZaz.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./hasIn-B69yjgv2.js";import"./isPlainObject-DJIrIqvg.js";import"./Col-DruUELZH.js";import"./responsiveObserve-ChmocN4c.js";import"./styleChecker-DfAMPleG.js";import"./devWarning-MTSIIkhh.js";import"./collapseMotion-D2RrGThV.js";import"./debounce-BUZtn0sP.js";import"./index-CalSw2eR.js";import"./css-DXc8wDa4.js";import"./compact-item-CDNQQAbH.js";import"./omit-HeMvMqzr.js";import"./index-Dn-jGRft.js";import"./useState-DblkWJ1i.js";const ee=["src"],oe=q({__name:"account",props:{tenantInfo:{}},setup(x){const I=x,m=U(),c=L(),_=F(),o=C({account:"superadmin",password:"123456",code:"",codeId:null,tenantId:""}),l=C({captchaImage:"",expirySeconds:0,codeId:""}),k=async s=>{u.set(E,s.accessToken),u.set(v,s.refreshToken),d.set(E,s.accessToken),d.set(v,s.refreshToken),await Y()?(p("您没有权限访问后台管理系统","warning"),u.clear(),d.clear()):(c.query.redirect?m.push({path:c.query.redirect,query:Object.keys(c.query.params).length>0?JSON.parse(c.query.params):""}):m.push("/dashboard/home"),p("登录成功!","success"))},A=()=>{_.value.validate().then(async()=>{const t=z.sm2.doEncrypt(o.password,"0484C7466D950E120E5ECE5DD85D0C90EAA85081A3A2BD7C57AE6DC822EFCCBD66620C67B0103FC8DD280E36C3B282977B722AAEC3C56518EDCEBAFB72C5A05312",1);o.tenantId=I.tenantInfo.id;const n=await M({...o,password:t});n.data.code==200?await k(n.data.result):p(n.data.message,"error")})},f=async()=>{o.code="";let s=await K();l.captchaImage="data:text/html;base64,"+s.data.result.img,l.expirySeconds=s.data.result.expirySeconds,o.codeId=s.data.result.id};return N(async()=>{f()}),R(()=>{}),(s,t)=>{const n=h("UserOutlined"),g=J,i=H,B=h("LockOutlined"),b=Q,y=X,S=W,D=Z,O=G;return P(),T("div",null,[e(O,{ref_key:"loginFormRef",ref:_,class:"login",model:o,name:"login-form","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off"},{default:a(()=>[e(i,{class:"login__field",name:"account",rules:[{required:!0,message:"请输入姓名!"}]},{default:a(()=>[e(g,{class:"login__input",value:o.account,"onUpdate:value":t[0]||(t[0]=r=>o.account=r),style:{width:"100%"},placeholder:"请输入账户"},{prefix:a(()=>[e(n,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),e(i,{class:"login__field",name:"password",rules:[{required:!0,message:"请输入密码!"}]},{default:a(()=>[e(b,{class:"login__input",value:o.password,"onUpdate:value":t[1]||(t[1]=r=>o.password=r),style:{width:"100%"},placeholder:"请输入密码"},{prefix:a(()=>[e(B,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),e(i,{class:"login__field",name:"code",rules:[{required:!0,message:"请输入验证码!"}]},{default:a(()=>[e(S,{gutter:16},{default:a(()=>[e(y,{span:12},{default:a(()=>[e(g,{class:"login__input",value:o.code,"onUpdate:value":t[2]||(t[2]=r=>o.code=r),style:{width:"100%"},placeholder:"请输入验证码",maxlength:4},null,8,["value"])]),_:1}),e(y,{span:12},{default:a(()=>[w("div",{class:V([l.expirySeconds>0?"login-content-code":"login-content-code-expired"]),onClick:f},[w("img",{class:"login-content-code-img",width:"130px",height:"38px",src:l.captchaImage,style:{cursor:"pointer"}},null,8,ee)],2)]),_:1})]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(D,{class:"login__submit",ype:"primary",onClick:A},{default:a(()=>t[3]||(t[3]=[j(" 登录 ")])),_:1})]),_:1})]),_:1},8,["model"])])}}}),be=$(oe,[["__scopeId","data-v-b2689a0a"]]);export{be as default};
