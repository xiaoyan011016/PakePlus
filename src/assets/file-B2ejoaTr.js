import{cB as S}from"./index-BGwiQ_ZP.js";function C(o,n,a=null){var i=o.split(","),h=i[0].match(/:(.*?);/)[1],g=atob(i[1]);let y=g.length;for(var p=new Uint8Array(y);y--;)p[y]=g.charCodeAt(y);return new File([p],n,{type:a||h})}function D(o,n,a){return a==null&&(a=o.type),new File([o],n,{type:a||o.type})}function T(o){return new Promise(n=>{const a=new FileReader;a.readAsDataURL(o),a.onload=i=>{n(i.target.result)}})}function _(o,n,a,i){a=a.map(e=>({...e,prop:e.key,label:e.title})).filter(e=>!["history"].includes(e.key));var h=new Array,g=new Array;const y={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}};let p=k(a),w=m(a),u=new Array(p);for(let e=0;e<u.length;e++)u[e]=new Array(w);let v=0;for(let e=0;e<a.length;e++){let s=a[e],r=m([s]),l=k([s]);for(let c=0;c<r;c++){v=v+c;for(let A=0;A<l;A++)J(A,v,c,s,u)}v++}for(let e=0;e<u.length;e++){let s=u[e];for(let r=0;r<s.length;r++)u[e][r]==null&&e>0&&(u[e][r]=u[e-1][r])}function J(e,s,r,l,c){e>0?l.children?J(e,v,r,l.children,c):c[e][s]=l[r]:c[e][s]=l}for(let e=0;e<u.length;e++){var E=new Array;let s=u[e];for(let r=0;r<s.length;r++){let l=s[r],c=200;l.width&&!isNaN(l.width)&&(c=parseInt(l.width)*.7),g.push({wpx:c}),E.push({v:l.label,t:"s",s:{font:{bold:!0},alignment:{wrapText:!0,horizontal:l.headerAlign?l.headerAlign:l.align?l.align:"",vertical:"center"},border:y}})}h.push(E)}var d=[],f=!1,t={s:{r:0,c:0},e:{r:0,c:0}};for(let e=0;e<w;e++){let s=u[0][e];for(let r=0;r<p;r++){let l=u[r][e];l==s&&f==!1?(f=!0,t.s={r,c:e}):l!=s&&f==!0?(t.e={r:r-1,c:e},t.s.r!=t.e.r?(d.push(JSON.parse(JSON.stringify(t))),f=!1,t={s:{r:0,c:0},e:{r:0,c:0}}):r==p-1&&f==!0?(t.e={r,c:e},t.s.r!=t.e.r&&l==s&&d.push(JSON.parse(JSON.stringify(t))),f=!1,t={s:{r:0,c:0},e:{r:0,c:0}}):(s=l,f=!0,t.s={r,c:e})):r==p-1&&f==!0&&(t.e={r,c:e},t.s.r!=t.e.r&&l==s&&d.push(JSON.parse(JSON.stringify(t))),f=!1,t={s:{r:0,c:0},e:{r:0,c:0}})}}f=!1;for(let e=0;e<p;e++){let s=u[e][0];for(let r=0;r<w;r++){let l=u[e][r];l==s&&f==!1?(f=!0,t.s={r:e,c:r}):l!=s&&f==!0?(t.e={r:e,c:r-1},t.s.c!=t.e.c?(d.push(JSON.parse(JSON.stringify(t))),f=!1,t={s:{r:0,c:0},e:{r:0,c:0}}):r==w-1&&f==!0?(t.e={r:e,c:r},t.s.r!=t.e.r&&l==s&&d.push(JSON.parse(JSON.stringify(t))),f=!1,t={s:{r:0,c:0},e:{r:0,c:0}}):(s=l,f=!0,t.s={r:e,c:r})):r==w-1&&f==!0&&(t.e={r:e,c:r},t.s.c!=t.e.c&&l==s&&d.push(JSON.parse(JSON.stringify(t))),f=!1,t={s:{r:0,c:0},e:{r:0,c:0}})}}o.forEach(e=>{var s=new Array;u[u.length-1].forEach(r=>{if(e.hasOwnProperty(r.prop)||O(e,r.prop)){let c="";if(e[r.prop]!=null)if(r.formatter){var l=r.formatter(e);c=b(l)}else c=e[r.prop];else if(O(e,r.prop))if(r.formatter){var l=r.formatter(e);c=b(l)}else c=O(e,r.prop);s.push({v:c,t:"s",s:{alignment:{wrapText:!0,horizontal:r.align?r.align:"",vertical:"center"},border:y}})}}),h.push(s)});const N=S.utils.aoa_to_sheet(h),x=S.utils.book_new();N["!cols"]=g,N["!merges"]=d,S.utils.book_append_sheet(x,N,i),S.writeFile(x,n+".xlsx")}function b(o){let n="";return o.children?o.children.default?n=o.children.default():o.children.forEach(a=>{n=n+b(a)}):n=o,n}function k(o){let n=1;function a(i,h){i.children&&i.children.length>0&&(h++,h>n&&(n=h),i.children.forEach(g=>a(g,h)))}return o.forEach(i=>a(i,1)),n}function m(o){let n=0;function a(i){i.children&&i.children.length>0?i.children.forEach(h=>a(h)):n++}return o.forEach(i=>a(i)),n}const O=(o,n)=>{const a=n.split(".");let i=o;for(const h of a)i=i[h];return i};export{D as a,C as b,_ as e,T as f};
